---
layout: post
title: macOS
---

1. toc
{:toc}

# Introductory #

macOS (Mac OS X or OS X) is a proprietary OS derived from Berkeley Software Distribution (BSD), and therefore is a Unix-like system. The main difference between macOS and other Unix-like distributions is that macOS is designed with *desktop* for personal PC.

# Shortcuts #

```
# Screenshot
shift + command + 3/4/5

# Lock Screen
ctrl + command + q
```

# Package Installation #

1. By [brew](https://brew.sh/) (CLI) and *brew mask* (GUI applications). Optionally update [brew mirror](https://mirrors.tuna.tsinghua.edu.cn/help/homebrew/).

   To debug Brew, try *brew doctor*.
2. By App Store.
3. By Jamf Self Service.

# General Setup #

1. touchpad tap with 1 click
2. Rime
3. Firefox
5. iTerm2
6. ssh; load-ssh-agent

# Shell Setup #

Set "bashrc" and "bash_profile" only after the following:

```bash
brew install xz

brew install bash
type -a bash

cat >>/etc/shells <<EOL
> /opt/homebrew/bin/bash
> EOL

chsh -s /opt/homebrew/bin/bash

openssl version -a
brew install openssl@1.1
/opt/homebrew/Cellar/openssl\@1.1/1.1.1o/bin/openssl version -a
PATH="/opt/homebrew/opt/openssl@1.1/bin:$PATH"

brew install emacs weechat tmux nmap utm gnupg

brew install libpq
PATH="/opt/homebrew/opt/libpq/bin:$PATH"
```

# Docker Desktop #

1. [Mac with Apple silicon](https://docs.docker.com/desktop/mac/install/)
2. For compatibility, execute `softwareupdate --install-rosetta`

# UTM #

UTM is a open source VMM supporting iOS and OSX. What is more, it supports Apple ARM64!

1. [Installation](https://mac.getutm.app/).
2. [Gallery](https://mac.getutm.app/gallery/).
3. After installation, remove and re-add the USB (DVD) drive, otherwise the boot menu break from time to time.
4. Follow tutorial [UTM Ubuntu 20.04](https://mac.getutm.app/gallery/ubuntu-20-04).

UTM uses *davfs2* to share files with host OS. Here is setup on guest OS:

```bash
# clipboard sharing, mouse integration
~ $ apt install spice-vdagent

# file shareing
~ $ apt install spice-webdavd davfs2

# group
~ $ sudo usermod -a -G davfs2 kong
~ $ sudo reboot

# /etc/fstab
http://127.0.0.1:9843   /media/webdav   davfs   _netdev,noauto,noexec,user,uid=kong,gid=kong    0       0

~ $ mkdir -p /media/webdav
~ $ mount /media/webdav
~ $ ls -al ~/.davfs2/

# auto password
# ~/.davfs2/secrets
/media/webdav   kong    kong

~ $ umount /media/wevdav
~ $ mount /media/wevdav
```

If just use Web browser (e.g. VM has X), then no need to install *davfs2*.
