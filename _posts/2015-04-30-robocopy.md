---
layout: post
title: robocopy
---

Robust File Copy for Windows command `robocopy` can *mirror* or *incrementally backup* files/directories, with versitle parameters.

The basic usage of `robocopy` is like:

```
robocopy <source-dir> <dest-dir> [file [file] ...] [options]

# robocopy d:\work e:\back *.txt *.doc *.bmp *.tif /s
```

By default, file/directory to copy can be wildcards like `*` (default to `*.*`; omitted usually). Read [Robocopy 指令範例參考 (MIR問題很多，小心使用)](http://basuya.blogspot.tw/2009/12/robocopy.html) or check `robocopy /?`.

The following is an example that mirrors disk parittion D:

```
# /MIR = /E /PURGE
F:\>robocopy D:\ E:\backup /MIR /COPY:DATS /DCOPY:DAT [/MINAGE:1] [/MAXAGE:7] /MAXLAD:20200627 /XA:SH /XD "System Volume Information" "$RECYCLE.BIN" /R:3 /W:10 /UNILOG+:G:\robocopy.log
```

1. `/MIR` mirrors a directory tree, equivalent to `/E /PURGE`.
2. `/COPY:DATS` copies Data, Attributes, Timestamp and NTFS Security ACLs fo files.

   By default, Security info of NTFS is not copied.
3. `/DCOPY:DAT` copies Data, Atrributes and Timestamp of directories.

   By default, Timestamp is not copied.
4. `/MINAGE:n` and `/MAXAGE:n` exclude files according to their ages.

   MINAGE guarantees that files being updated won't copied. On the contrary, MAXAGE skip files old enough.

   `n` can be the number of days or date in `YYYYMMDD` format. It should adapt to the bakcup *cron* job.
5. `/MINLAD:n` and `/MAXLAD:n` exclude files according to their Last Access Date.
6. `/XA:SH` excludes files with Hidden or System attributes.

   In return, we have `/IA:` to copy only files with the specified attributes.
7. `/XD <dir>` excludes specific directories.

   In return, we have `/XF` to exclude specific files.
8. `/R:3` retries 3 times on failed copies. By default, it is 1 million.

   `/W:10` wait for 10 seconds between retries.
9. `/UNILOG+:G:\robocopy.log` redirects log to file with UNICODE encoding.

The Linux alternative of `robocopy` is `rsync`. Please check *fmt.pdf*.